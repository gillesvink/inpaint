when:
  event: [push, manual]
  path:
    include: ["*.rs", "*.toml", "*.py"]
steps:
  test_rust:
    image: rust
    commands:
      - apt update && apt install python3-dev -y
      - cargo test --no-default-features --release
      - cargo test --features python-bindings --release
      - cargo test --features image --release

  test_python:
    image: ghcr.io/astral-sh/uv:debian
    commands:
      - uv run pytest
